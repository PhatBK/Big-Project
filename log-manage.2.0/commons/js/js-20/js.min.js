var ip_private=null,ip_public=null;function getUserIP(a){function b(k){g[k]||a(k),g[k]=!0}var c=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,d=new c({iceServers:[]}),f=function(){},g={},h=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/g;d.createDataChannel(''),d.createOffer().then(function(k){k.sdp.split('\n').forEach(function(l){0>l.indexOf('candidate')||l.match(h).forEach(b)}),d.setLocalDescription(k,f,f)}).catch(function(){}),d.onicecandidate=function(k){k&&k.candidate&&k.candidate.candidate&&k.candidate.candidate.match(h)&&k.candidate.candidate.match(h).forEach(b)}}getUserIP(function(a){ip_private=a}),$.getJSON('https://api.ipify.org?format=json',function(a){ip_public=a.ip}),function(a,b){'object'==typeof exports&&'undefined'!=typeof module?module.exports=b(require('video.js')):'function'==typeof define&&define.amd?define(['video.js'],b):a.videojsEventTracking=b(a.videojs)}(this,function(a){'use strict';a='default'in a?a['default']:a;var d=function(){var w=this,x=null,y=!1,z=!1,A=!1,B=!1,C=0,D=!1,E=0,F=0,G=null,H=function(){x&&clearTimeout(x),y=!1,z=!1,A=!1,B=!1,C=0,D=!1,E=0};player.on('tracking:resolution',function(L,M){F=M.bitrateNetwork,G='"'+M.videoWidth+'x'+M.videoHeigth+'"'}),player.on('tracking:watched-time',function(L,M){E=M.watchedTime}),this.on('dispose',H),this.on('loadstart',H),this.on('ended',H),this.on('pause',function(){A=!1,w.scrubbing()&&(y=!0,x=setTimeout(function(){y=!1},200))}),this.on('waiting',function(){!1==A&&!1==y&&0<w.currentTime()&&(A=new Date,z=+w.currentTime().toFixed(0),D=+w.readyState())}),this.on('timeupdate',function(){var M=+w.currentTime().toFixed(0);if(A&&M!==z){B=new Date;var N=(B-A)/1e3;N.toFixed(3),A=!1,z=!1,C++,w.trigger('tracking:buffered',{currentTime:+M,readyState:+D,secondsToLoad:+N.toFixed(3),bufferCount:+C,watchedTime:+E,bitrateNetwork:F,resolution:G})}})},f=function(){var w=this,x=0,y=null,z=!1,A=0,B=function(){y&&clearTimeout(y),x=0,z=!1,A=0};w.on('dispose',B),w.on('loadstart',B),w.on('ended',B),w.on('pause',function(){w.scrubbing()||z||(y=setTimeout(function(){var C=w.currentTime().toFixed(0);x++,w.trigger('tracking:pause',{pauseCount:x,currentTime:C,watchedTime:A})},300))}),w.on('tracking:watched-time',function(C,D){A=D.watchedTime})},g=function(){var w=this,x=!1,y=!1,z=!1,A=0,B=0,C=0,D=function(){x=!1,y=!1,z=!1,A=0,B=0,C=0};w.on('dispose',D),w.on('loadstart',D),w.on('tracking:pause',function(){return B++}),w.on('tracking:seek',function(){return C++}),w.on('timeupdate',function(){var G=+w.currentTime().toFixed(0),H={seekCount:C,pauseCount:B,currentTime:G,duration:A};G===x?(x=!1,w.trigger('tracking:first-quarter',H)):G===y?(y=!1,w.trigger('tracking:second-quarter',H)):G===z?(z=!1,w.trigger('tracking:third-quarter',H)):void 0}),w.on('ended',function(){var G={seekCount:C,pauseCount:B,currentTime:A,duration:A};w.trigger('tracking:fourth-quarter',G)}),w.on('durationchange',function(){if(A=+w.duration().toFixed(0),0<A){var G=(A/4).toFixed(0);x=+G,y=2*+G,z=3*+G}})},h=function(){var v=this,w=null,x=null,y=0,z=null,A=null,B=function(){w=null,x=null,y=0,z=null,A=null},C=navigator.connection||navigator.mozConnection||navigator.webkitConnection,D=navigator.connection.effectiveType||navigator.connection.type;z=C.downlink,A=D,C.addEventListener('change',function(){z=C.downlink,A=D}),v.on('dispose',B),v.on('loadstart',B),v.on('ended',B),v.on('error',B),v.on('suspend',function(){y++,w=v.videoWidth(),x=v.videoHeight(),z=navigator.connection.downlink,v.trigger('tracking:resolution',{videoWidth:w,videoHeigth:x,resolutionChangeCount:y,bitrateNetwork:z,connectionType:A})})},j=function(){var w=['MEDIA_ERR_CUSTOM','MEDIA_ERR_ABORTED','MEDIA_ERR_NETWORK','MEDIA_ERR_DECODE','MEDIA_ERR_SRC_NOT_SUPPORTED','MEDIA_ERR_ENCRYPTED'];player.on('error',function(){var x=player.error().code,y=player.error().message,z=null;for(let B=0;B<w.length;B++)x===B&&(z=w[B]);var A={error_code:x,error_type:z,error_message:y};player.trigger('tracking:error',A)})},k=function(v){if('undefined'!=typeof v&&'function'==typeof v.performance){var w=this,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=[],F=0,G=function(){x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=[],F=0},H=function(){var K={pauseCount:y,seekCount:x,bufferCount:z,totalDuration:A,watchedDuration:B,bufferDuration:C,initialLoadTime:D,suspendCount:F};v.performance.call(w,K)},I=function(){H(),G()};'function'==typeof window.addEventListener&&(window.addEventListener('beforeunload',I),w.on('dispose',function(){window.removeEventListener('beforeunload',I)})),w.on('loadstart',function(){0<A&&H(),G()}),w.on('ended',I),w.on('dispose',I),w.on('timeupdate',function(){var J=+w.currentTime().toFixed(0);0>E.indexOf(J)&&E.push(J),B=E.length}),w.on('loadedmetadata',function(){A=+w.duration().toFixed(0)}),w.on('loadeddata',function(){A=+w.duration().toFixed(0)}),w.on('tracking:seek',function(J,K){x=K.seekCount}),w.on('tracking:pause',function(J,K){y=K.pauseCount}),w.on('tracking:buffered',function(J,K){z=K.bufferCount,C=+(C+K.secondsToLoad).toFixed(3)}),w.on('tracking:firstplay',function(J,K){D=K.secondsToLoad}),w.on('tracking:suspend',function(J,K){F=K.suspendCount})}},l=function(){var w=this,x=!1,y=0,z=0,A=0,B=function(){x=!1,y=0,z=0,A=0};this.on('dispose',B),this.on('loadstart',function(){B(),y=new Date}),this.on('loadeddata',function(){z=new Date,A=(z-y)/1e3}),this.on('playing',function(){x||(x=!0,w.trigger('tracking:firstplay',{secondsToLoad:+A.toFixed(3)}))})},m=function(){var w=this,x=0,y=!0,z=0,A=function(){x=0,y=!0,z=0};w.on('dispose',A),w.on('loadstart',A),w.on('ended',A),w.on('error',A),w.on('play',function(){y=!1}),w.on('tracking:watched-time',function(B,C){z=C.watchedTime}),w.on('pause',function(){if(!y&&w.scrubbing()){var B=+w.currentTime().toFixed(0);x++,w.trigger('tracking:seek',{seekCount:+x,seekTo:B,watchedTime:z})}})},n=function(){var w=this,x=0,y=!1,z=function(){x=0,y=!1};w.on('dispose',z),w.on('loadstart',z),w.on('ended',z),w.on('error',z),w.on('suspend',function(){w.scrubbing()||y||(x++,w.trigger('tracking:suspend',{suspendCount:x}))})},o=function(){var v=0,w=[],x=function(){v=0,w=[]};player.on('dispose',x),player.on('loadstart',x),player.on('ended',x),player.on('error',x),player.on('timeupdate',function(){var y=+player.currentTime().toFixed(0);0>w.indexOf(y)&&w.push(y),v=w.length,player.trigger('tracking:watched-time',{watchedTime:v.toFixed(3)})})},p=function(){var w=this,y=null,z=0,A=!1,B=!1},q=function(){},r=a.registerPlugin||a.plugin,s=a.getPlugin||a.plugin,t=function(){f.apply(this,arguments),d.apply(this,arguments),g.apply(this,arguments),l.apply(this,arguments),m.apply(this,arguments),k.apply(this,arguments),j.apply(this,arguments),n.apply(this,arguments),h.apply(this,arguments),o.apply(this,arguments),q.apply(this,arguments),p.apply(this,arguments)};return'undefined'==typeof s('eventTracking')&&r('eventTracking',t),t.VERSION='0.9.9',t});let TIMEOUT=1e4,service_code={token:null};const serviceApp={name:'KenhHai',type:'web'},logging_host={host:'http://192.168.1.18:9001/web/all/event/log-datas',getToken:'http://192.168.1.18:9001/api/util-service/call-service/help-me/token/web'},event_labels={abort:'abort',emptied:'emptied',ended:'ended',error:'error',interruptbegin:'interruptbegin',interruptend:'interruptend',loadeddata:'loadeddata',loadedmetadata:'loadedmetadata',loadstart:'loadstart',load:'load',loadend:'loadend',mozaudioavailable:'mozaudioavailable',pause:'pause',play:'play',playing:'playing',progress:'progress',ratechange:'ratechange',seeked:'seeked',seeking:'seeking',suspend:'suspend',timeupdate:'timeupdate',volumechange:'volumechange',waiting:'waiting'},resolutions={CD:[[352,240],[352,288]],SD480:[[352,480],[528,480],[544,480],[640,480],[704,480],[720,480]],SD576:[[480,576],[544,576],[704,576],[720,576]],DVD:[[720,480],[720,576]],HD:[[1280,720],[1366,768]],FHD:[[1440,1080],[1920,1080]],'4K':[[3840,2160]],'8K':[[7680,4320]],'16K':[[15360,8640]]},media_infos={current_uri:window.location.pathname,media_id:0,media_category:null,media_name:null,media_like_count:0,media_viewed:null,media_duration:0},dataLogs={mediaInfos:{mediaID:null,mediaName:null,mediaCategory:null,mediaDuration:0},userID:null,ipPublic:null,ipPrivate:null,userAgent:null,time:null,bitrateNetwork:0,connectType:null,seekCount:0,pauseCount:0,bufferCount:0,suspendCount:0,initialLoadTime:0,watchedDuration:0,bufferDuration:0,currentTime:0,watchingTime:0,errorCode:-1,errorMessage:null,status:null,event:null,bufferInfinite:!1,isCloseTab:!1};let host=logging_host.host,UserID=null;const user_agent=navigator.userAgent;let timer=null,countASC=0,performanceFlag=!1,endedFlag=!1,backupObject=null,isCloseTab=!1;window.onload=function(){null===service_code.token?($.ajaxSetup({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content')}}),$.ajax({url:logging_host.getToken,type:'POST',contentType:'application/json',data:JSON.stringify({request:'token',type:serviceApp.type,service:serviceApp.name}),dataType:'json',cache:!1,success:function(b){service_code.token=b.token,console.log('service token reciveced...')},error:function(b){console.log(b)}})):console.log('Service Token Already...')};const resetDataLogs=()=>{dataLogs.seekCount=0,dataLogs.pauseCount=0,dataLogs.bufferCount=0,dataLogs.suspendCount=0,dataLogs.initialLoadTime=0,dataLogs.watchedDuration=0,dataLogs.bufferDuration=0,dataLogs.currentTime=0,dataLogs.watchingTime=0},TimeNormalFormat=a=>{let b=a.getFullYear()+'-'+(a.getMonth()+1)+'-'+a.getDate()+'T'+a.getHours()+':'+a.getMinutes()+':'+a.getSeconds()+'Z';return b},findCookie=a=>{for(var b=null,c=document.cookie.split(';'),d=0;d<c.length;d++)c[d].split('=')[0]===a&&(b=c[d].split('=')[1]);return b};function checkUserID(){if(null===findCookie('user_id')){var a='KenhHai'+Math.floor(1e6*Math.random()+1);UserID='8866phatnh'+Math.floor(1e6*Math.random())+1+'kenh_hai_web',document.cookie='user_id= '+UserID+'; expires=Thu, 18 Dec 2020 12:00:00 UTC',document.cookie='username='+a+'; expires=Thu, 18 Dec 2020 12:00:00 UTC'}else UserID=findCookie('user_id')}checkUserID();function newAjaxSendDataNodejs(a,b){$.ajaxSetup({headers:{'X-CSRF-TOKEN':$('meta[name="csrf-token"]').attr('content'),service_token:service_code.token}}),$.ajax({url:a,type:'POST',contentType:'application/json',data:JSON.stringify(b),dataType:'json',cache:!1,success:function(c){TIMEOUT=c.TIMEOUT,console.log(TIMEOUT),console.log(c)},error:function(c){console.log(c)}})}player.on('loadedmetadata',function(){media_infos.media_duration=player.duration().toFixed(0),dataLogs.mediaInfos.mediaDuration=parseInt(player.duration().toFixed(0)),dataLogs.mediaInfos.mediaID='12345',dataLogs.mediaInfos.mediaName='Laravel',dataLogs.mediaInfos.mediaCategory='Hoat Hinh'}),player.eventTracking({performance:function(a){dataLogs.pauseCount=a.pauseCount,dataLogs.seekCount=a.seekCount,dataLogs.bufferCount=a.bufferCount,dataLogs.suspendCount=a.suspendCount,dataLogs.initialLoadTime=a.initialLoadTime,dataLogs.bufferDuration=a.bufferDuration,dataLogs.watchedDuration=a.watchedDuration,performanceFlag=!0,dataLogs.status='success',dataLogs.event='performance'}}),player.on('tracking:resolution',function(a,b){dataLogs.bitrateNetwork=b.bitrateNetwork,dataLogs.connectType=b.connectionType}),player.on('tracking:error',function(a,b){dataLogs.errorCode=b.errorCode,dataLogs.errorMessage=b.errorMessage,dataLogs.status='success',dataLogs.event='error';let c=logging_host.host;newAjaxSendDataNodejs(c,dataLogs),clearInterval(timer),resetDataLogs(),console.log('Player error...')}),player.on('tracking:firstplay',function(a,b){if(null===findCookie('user_id')){var c='KenhHai'+Math.floor(1e6*Math.random()+1);UserID='8866phatnh'+Math.floor(1e6*Math.random())+1+'kenh_hai_web',document.cookie='user_id= '+UserID+'; expires=Thu, 18 Dec 2020 12:00:00 UTC',document.cookie='username='+c+'; expires=Thu, 18 Dec 2020 12:00:00 UTC'}else UserID=findCookie('user_id');dataLogs.userID=UserID,dataLogs.initialLoadTime=b.secondsToLoad,dataLogs.ipPrivate=ip_private,dataLogs.ipPublic=ip_public,dataLogs.userAgent=user_agent}),player.on('tracking:seek',function(a,b){dataLogs.seekCount=b.seekCount,dataLogs.watchingTime=parseFloat(b.watchedTime),dataLogs.watchedDuration=parseFloat(b.watchedTime)}),player.on('tracking:performance',function(a,b){dataLogs.pauseCount=b.pauseCount,dataLogs.seekCount=b.seekCount,dataLogs.bufferCount=b.bufferCount,dataLogs.suspendCount=b.suspendCount,dataLogs.initialLoadTime=b.initialLoadTime,dataLogs.bufferDuration=b.bufferDuration.toFixed(3),dataLogs.watchedDuration=b.watchedDuration,performanceFlag=!0,dataLogs.status='success',dataLogs.event='performance'}),player.on('tracking:buffered',function(a,b){dataLogs.currentTime=b.currentTime,dataLogs.bufferDuration+=+b.secondsToLoad.toFixed(3),dataLogs.bufferCount=b.bufferCount,dataLogs.watchingTime=parseFloat(b.watchedTime),dataLogs.watchedDuration=parseFloat(b.watchedTime),dataLogs.event='buffered'}),player.on('tracking:suspend',function(a,b){dataLogs.suspendCount=b.suspendCount,dataLogs.event='suspend'}),player.on('tracking:pause',function(a,b){dataLogs.pauseCount=b.pauseCount,dataLogs.watchingTime=parseFloat(b.watchedTime),dataLogs.watchedDuration=parseFloat(b.watchedTime)}),player.on('play',function(){timer=window.setInterval(function(){player.on('tracking:watched-time',function(b,c){dataLogs.watchingTime=parseFloat(c.watchedTime),dataLogs.watchedDuration=parseFloat(c.watchedTime)}),dataLogs.time=TimeNormalFormat(new Date);let a=logging_host.host;newAjaxSendDataNodejs(a,dataLogs),countASC++},TIMEOUT),console.log('Set Timer Object when player play...')}),player.on('pause',function(){clearInterval(timer),console.log('Clear Timer Object when player Pause...')}),player.on('ended',function(){if(performanceFlag){let a=logging_host.host;dataLogs.status='success',dataLogs.event='ended',newAjaxSendDataNodejs(a,dataLogs),clearInterval(timer),resetDataLogs(),console.log('Destroy Send Data...')}endedFlag=!0}),player.on('dispose',function(){dataLogs.status='success',dataLogs.event='dispose',clearInterval(timer),resetDataLogs()}),player.on('stalled ',function(){let b=logging_host.host;dataLogs.status='idle',dataLogs.event='stalled',newAjaxSendDataNodejs(b,dataLogs),clearInterval(timer),resetDataLogs()});const backupDataFunction=(a,b)=>{return b=Object.assign({},a),'undefined'==typeof Storage?console.log('Not saved data'):(localStorage.setItem('beforeData',JSON.stringify(b)),console.log('Saved data to local storge html5')),b};var finalSendData=function(b){let c=logging_host.host;dataLogs.status='success',dataLogs.event=b,newAjaxSendDataNodejs(c,dataLogs),clearInterval(timer),resetDataLogs()};